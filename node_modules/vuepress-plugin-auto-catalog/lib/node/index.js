import{catalogLocales as R}from"vuepress-plugin-components";import{Logger as x,getTitleFromFilename as K,getLocales as $}from"vuepress-shared/node";import{useSassPalettePlugin as A}from"vuepress-plugin-sass-palette";import{createPage as L}from"@vuepress/core";import{createRequire as G}from"node:module";const I=new x("vuepress-plugin-auto-catalog"),P=async(o,{component:c="AutoCatalog",exclude:u=[],frontmatter:l=()=>({}),level:n=3})=>{const{env:{isDebug:r},pages:m}=o,s=new Set,d=`<${c}${[1,2].includes(n)?` :level="${n}"`:""} />
`;m.forEach(({path:t,pathLocale:i})=>{let e=t;for(;e!==i;)e=e.replace(/\/(?:[^/]+\/?)$/,"/"),!s.has(e)&&u.every(p=>!e.match(p))&&m.every(({path:p})=>p!==e)&&(r&&I.info(`Generating catalog ${e}}`),s.add(e))}),await Promise.all(Array.from(s).map(t=>decodeURI(t)).map(t=>{const[,i]=/\/([^/]+)\/?$/.exec(t)||[],e=K(i);return L(o,{frontmatter:{title:e,...l(t)||{}},content:d,path:t})})).then(t=>{o.pages.push(...t)})},h=G(import.meta.url),w=(o,{iconRouteMetaKey:c,indexRouteMetaKey:u,orderRouteMetaKey:l,titleRouteMetaKey:n})=>{const r=`import { defineClientConfig } from "@vuepress/client";
import { defineAsyncComponent, h } from "vue";
import { hasGlobalComponent } from "${h.resolve("vuepress-shared/client")}";

export default defineClientConfig({
  enhance: ({ app }) => {
    if (!hasGlobalComponent("AutoCatalog", app))
      app.component("AutoCatalog", () =>
        h(
          defineAsyncComponent(
            () =>
              import("${h.resolve("vuepress-plugin-components/client/components/Catalog.js")}")
          ),
          {
            titleGetter: (meta) => meta["${n}"],
            iconGetter: (meta) => meta["${c}"],
            orderGetter: (meta) => meta["${l}"],
            shouldIndex: (meta) => Boolean(meta["${u}"]),
          }
        )
      );
  },
});
`;return o.writeTemp("auto-catalog/config.js",r)},F=({component:o="AutoCatalog",exclude:c=[],frontmatter:u=()=>({}),getIcon:l,iconRouteMetaKey:n="i",getIndex:r,indexRouteMetaKey:m="I",level:s=3,locales:d,getOrder:t,orderRouteMetaKey:i="O",getTitle:e,titleRouteMetaKey:p="title"}={})=>f=>(A(f,{id:"hope"}),{name:"vuepress-plugin-auto-catalog",define:()=>({CATALOG_LOCALES:$({app:f,name:"catalog",default:R,config:d})}),extendsPage:a=>{const g={},C=e==null?void 0:e(a),v=l==null?void 0:l(a),y=t==null?void 0:t(a),M=r==null?void 0:r(a);C&&(g[p]=C),v&&(g[n]=v),M!==!1&&(g[m]=1),y!==null&&(g[i]=y),a.routeMeta={...a.routeMeta,...g}},onInitialized:async a=>P(a,{component:o,exclude:c,frontmatter:u,level:s}),...o==="AutoCatalog"||!o?{clientConfigFile:()=>w(f,{titleRouteMetaKey:p,iconRouteMetaKey:n,indexRouteMetaKey:m,orderRouteMetaKey:i})}:{}});export{F as autoCatalogPlugin};
//# sourceMappingURL=index.js.map
